<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>TRON dApp ‚Äî Trust Wallet</title>
</head>
<body>
<h2>TRON dApp ‚Äî Trust Wallet</h2>
<button onclick="connectWallet()">–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª—ë–∫</button>
<pre id="status">–û–∂–∏–¥–∞–Ω–∏–µ...</pre>

<script>
async function connectWallet() {
    const status = document.getElementById("status");

    if (!window.tronWeb) {
        status.textContent = "‚ùå Trust Wallet –Ω–µ –Ω–∞–π–¥–µ–Ω (—Ç–æ–ª—å–∫–æ –º–æ–±–∏–ª—å–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä)";
        return;
    }

    // –ñ–¥—ë–º, –ø–æ–∫–∞ –∫–æ—à–µ–ª—ë–∫ –≥–æ—Ç–æ–≤
    const tronWeb = await new Promise((resolve, reject) => {
        let tries = 0;
        const interval = setInterval(() => {
            if (window.tronWeb && window.tronWeb.ready) {
                clearInterval(interval);
                resolve(window.tronWeb);
            }
            tries++;
            if (tries > 20) {
                clearInterval(interval);
                reject("Trust Wallet –Ω–µ –≥–æ—Ç–æ–≤");
            }
        }, 500);
    });

    const address = tronWeb.defaultAddress.base58;
    status.textContent = `‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ: ${address}`;

    // –ü–æ–ª—É—á–∞–µ–º –±–∞–ª–∞–Ω—Å TRX
    const balanceSun = await tronWeb.trx.getBalance(address);
    const balanceTRX = balanceSun / 1_000_000;
    status.textContent += `\nüí∞ –ë–∞–ª–∞–Ω—Å: ${balanceTRX} TRX`;
}
</script>
</body>
</html>
